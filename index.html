<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milatro - by miko</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
</head>

<body>
    <audio id="music-main" src="music/Main Theme.mp3" loop></audio>
    <audio id="music-shop" src="music/Shop Theme.mp3" loop></audio>
    <audio id="music-boss" src="music/Boss Theme.mp3" loop></audio>
    <audio id="music-arcana" src="music/Arcana Theme.mp3" loop></audio>
    <audio id="music-celestial" src="music/Celestial Theme.mp3" loop></audio>
    <div class="liquid-bg"></div>

    <div class="game-container">
        <div class="left-panel">
            <div class="blind-panel">
                <div class="blind-title">Ciega pequeña</div>
                <div class="blind-info">
                    <div class="blind-target">Anota al menos</div>
                    <div class="blind-score" id="blind-score">300</div>
                    <div class="blind-score" id="target">300</div>
                    <div class="blind-reward">Recompensa: $$$</div>
                </div>
                <div class="score-display">
                    <div class="score-label" id="score-label">Puntuación</div>
                    <div class="score-value" id="score">0</div>
                </div>
                <div class="stats-grid">
                    <div class="stat-box points-background">
                        <div class="stat-label points">puntos</div>
                        <div class="stat-value" id="hand-score-points">0</div>
                    </div>
                    <div class="stat-box mult-background">
                        <div class="stat-label mult">mult</div>
                        <div class="stat-value" id="hand-score-mult">0</div>
                    </div>
                </div>
            </div>

            <div class="control-buttons">
                <button class="btn-small btn-info" onclick="showCombinations()">info</button>
            </div>

            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">Manos</div>
                    <div class="stat-value" id="hands">4</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Descartes</div>
                    <div class="stat-value" id="discards">3</div>
                </div>
                <div class="stat-box money-box">
                    <div class="stat-label">Monedas</div>
                    <div class="stat-value" id="money">$4</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Ronda</div>
                    <div class="stat-value" id="round">0</div>
                </div>
            </div>
        </div>

        <div class="play-area">
            <div id="joker-container" class="joker-container"></div>
            <div class="selected-area" id="selected-area">
                <div id="empty-message">Selecciona cartas para jugar</div>
            </div>

            <div class="hand-info">
                <div class="hand-name" id="hand-name">Selecciona cartas</div>
                <div class="hand-score" id="hand-score">Puntos: 0 | Mult: 0</div>
            </div>

            <div class="hand" id="hand"></div>

            <div class="controls">
                <button class="btn" id="play-btn" disabled>Jugar mano</button>

                <div class="sort-buttons">
                    <button class="btn-sort" id="sort-types" title="Organizar por palo">tipos</button>
                    <button class="btn-sort" id="sort-pairs" title="Organizar por pares">pares</button>
                </div>

                <button class="btn" id="discard-btn" disabled>Descartar</button>
            </div>
        </div>

        <div class="right-panel">
            <div class="deck-container" id="deck-container">
                <div class="deck-card"></div>
                <div class="deck-card"></div>
                <div class="deck-card deck-card-image" style="background-image:url(./images/jokers/blue_deck.png)"></div>
            </div>
            <div class="deck-info">
                <div id="deck-count">52/52</div>
            </div>
        </div>
        <div class="blind-selection-menu" style="display: none;">
            <h2>Selecciona una ciega</h2>
            <button class="btn btn-blind" onclick="selectBlind(1)">Ciega 1 (Fácil)</button>
            <button class="btn btn-blind" onclick="selectBlind(2)">Ciega 2 (Media)</button>
            <button class="btn btn-blind" onclick="selectBlind(3)">Ciega 3 (Difícil)</button>
        </div>
        <div class="intro-logo" id="intro-logo" onclick="enterMainMenu()">
            <h1>ADVERTENCIA!!!</h1>
            <p>ESTO ES UNA BETA SERRADA! NO ESTA TERMINADO Y PROBABLEMENTE NUNCA LO ESTARA</p>
            <p>haga click para comenzar</p>
            <img src="./images/jokers/joker.png" class="loading-joker" alt="loading">
        </div>
        <div class="boot-menu">
            <div class="boot-menu-main">
                <div class="boot-menu-main">
                    <!-- Logo animado -->
                    <img src="./images/logo.png" class="boot-logo" alt="Milatro Logo">

                    <!-- Contenedor gris de los botones -->
                    <div class="button-container">
                        <button class="btn btn-play" onclick="showStartGameMenu()">Play</button>
                        <button class="btn btn-collection"
                            onclick="showCollectionsMenu()">Collection</button>
                        <button id="install-button" class="btn" style="display: none;">Install</button>
                    </div>
                </div>
            </div>
            <!-- Versión del juego arriba a la derecha -->
            <div class="game-version" id="game-version">???</div>
            <div class="boot-menu-start-game" style="display: none;">
                <img src="./images/logo.png" class="boot-logo" alt="Milatro Logo">
                <div class="button-container">
                    <div>
                        <label for="deck-type">Tipo de Baraja:</label>
                        <select id="deck-type">
                            <option value="standard">Estándar</option>
                            <option value="expanded">Expandida</option>
                            <option value="thematic">Temática</option>
                        </select>
                    </div>
                    <div>
                        <label for="difficulty">Dificultad:</label>
                        <select id="difficulty">
                            <option value="easy">Fácil</option>
                            <option value="normal">Normal</option>
                            <option value="hard">Difícil</option>
                        </select>
                    </div>
                    <div>
                        <label for="joker-collection">Colección de Comodines:</label>
                        <select id="joker-collection">
                            <option value="none">Ninguno</option>
                            <option value="basic">Básica</option>
                            <option value="complete">Completa</option>
                        </select>
                    </div>
                    <div>
                        <label for="animation-speed">Velocidad de Animación:</label>
                        <select id="animation-speed">
                            <option value="1">Normal (1x)</option>
                            <option value="0.5">Doble (2x)</option>
                            <option value="0.25">Cuádruple (4x)</option>
                            <option value="instant">Instantánea (Sin animaciones)</option>
                        </select>
                    </div>
                    <button class="btn-play" onclick="prepareGame()">Iniciar</button>
                    <button class="btn-back" onclick="goToMenu()">atras</button>
                </div>
            </div>
        </div>
        <div class="collections-menu" style="display: none;">
            <div class="collections-menu-container">
                <h1>Colecciones</h1>
                <div class="collection-nav">
                    <button class="collection-nav-button active" data-section="sub-effects" onclick="switchCollectionSection('sub-effects')">Sub-Efectos</button>
                    <button class="collection-nav-button" data-section="jokers" onclick="switchCollectionSection('jokers')">Jokers</button>
                    <button class="collection-nav-button" data-section="black-cards" onclick="switchCollectionSection('black-cards')">Cartas Negras</button>
                    <button class="collection-nav-button" data-section="stats" onclick="switchCollectionSection('stats')">Estadísticas</button>
                </div>
                <div id="collection-content" class="collection-content"></div>
                <div id="stats-content" class="stats-content" style="display: none;">
                    <h2>Estadísticas del Juego</h2>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <h3>Juego Iniciado</h3>
                            <p id="stats-boots">0</p>
                        </div>
                        <div class="stat-item">
                            <h3>Horas Jugadas</h3>
                            <p id="stats-hours">0</p>
                        </div>
                    </div>
                    <h3>Progreso Total</h3>
                    <div class="progress-bar-container">
                        <div id="progress-bar" class="progress-bar"></div>
                    </div>
                    <p id="completion-percentage">0%</p>
                </div>
                <br>
                <br>
                <button class="btn-back" onclick="hideCollectionsMenu()">Volver</button>
            </div>
        </div>
        <div class="shop-menu" style="display: none;">
            <div class="shop-menu-container">
                <h1>Tienda de Mejoras</h1>
                <div class="shop-content">
                    <div id="shop-preview-area">
                        <p class="shop-preview-placeholder">Selecciona un comodín para ver los detalles</p>
                    </div>
                    <div class="shop-options"></div>
                </div>
                <div class="shop-footer">
                    <div class="money-box stat-box">
                        <div class="stat-label">Monedas</div>
                        <div class="stat-value" id="money-store">$4</div>
                    </div>
                    <!-- Small jokers will be inserted here dynamically -->
                    <button class="btn-play" onclick="continueGame()">Continuar</button>
                </div>
            </div>

        </div>
        <div class="modal" id="combinations-modal">
            <div class="modal-content">
                <span class="close-modal" onclick="closeCombinations()">&times;</span>
                <h2>Combinaciones de Poker</h2>
                <div class="hand-combo">
                    <span>Escalera Real</span>
                    <span>100 + 8x</span>
                </div>
                <div class="hand-combo">
                    <span>Escalera de Color</span>
                    <span>100 + 8x</span>
                </div>
                <div class="hand-combo">
                    <span>Póker</span>
                    <span>60 + 7x</span>
                </div>
                <div class="hand-combo">
                    <span>Full House</span>
                    <span>40 + 4x</span>
                </div>
                <div class="hand-combo">
                    <span>Color</span>
                    <span>35 + 4x</span>
                </div>
                <div class="hand-combo">
                    <span>Escalera</span>
                    <span>30 + 4x</span>
                </div>
                <div class="hand-combo">
                    <span>Trío</span>
                    <span>30 + 3x</span>
                </div>
                <div class="hand-combo">
                    <span>Doble Pareja</span>
                    <span>20 + 2x</span>
                </div>
                <div class="hand-combo">
                    <span>Pareja</span>
                    <span>10 + 2x</span>
                </div>
                <div class="hand-combo">
                    <span>Carta Alta</span>
                    <span>5 + 1x</span>
                </div>
            </div>
        </div>

        <div class="game-over" id="game-over">
            <div class="game-over-content">
                <h2 id="game-result">¡Juego Terminado!</h2>
                <div class="final-score">Puntuación Final: <span id="final-score">0</span></div>
                <button class="btn btn-play enabled" onclick="restartGame()">Jugar de Nuevo</button>
            </div>
        </div>

        <div class="recovery-menu" style="display: none;">
            <div class="recovery-menu-container">
                <h2>Recuperar partida</h2>
                <p>se a detectado una partida sin terminar, ¿quieres continuarla?</p>
                <div>
                    <button class="btn btn-play" onclick="continueGame()">Continuar</button>
                    <button class="btn btn-back" onclick="newGame()">Crear nueva</button>
                </div>
            </div>
        </div>

        <div class="notification" id="notification"></div>

        <script src="boot_menu.js"></script>
        <script src="music_manager.js"></script>
        <script src="collections_menu.js"></script>
        <script src="recovery.js"></script>
        <script src="installer.js"></script>
        <script src="meta_manager.js"></script>
        <script src="updater.js"></script>
        <script src="debug.js"></script>
        <script src="analytics.js"></script>
        <script src="PWA.js"></script>
        <script src="push_notifications.js"></script>
        <script src="share.js"></script>
        <script src="shortcuts.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }
    </script>
</body>

</html>